<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0104)https://cw.felk.cvut.cz/brute/data/ae/release/2023z_b4m33pal/pal_2023/evaluation/input.php?task=dictdist -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="cache-control" content="no-cache">
  <link rel="stylesheet" type="text/css" href="./assignment_files/default.css">
  <title>Problem Assignment BM33PAL</title>
</head>
<body>
<div class="main">


<h2><font color="blue">Hamming dictionary distance</font></h2>

<p align="justify">
Let <i>D</i> = {<i>d</i><sub>1</sub>,..., <i>d</i><sub><i>m</i></sub>} be a dictionary of <i>m</i> words, whose length is at least <i>F</i> (where <i>F</i> ≥ 3), over an alphabet <i>A</i>.
For two words <i>u</i>, <i>v</i> of the same length, let HD(<i>u</i>, <i>v</i>) denote their Hamming distance.
For a text <i>T</i> over <i>A</i>, we say that <i>T</i> = <i>w</i><sub>1</sub> ... <i>w</i><sub><i>k</i></sub> is a feasible factorization of <i>T</i> with respect to
<i>D</i> and <i>F</i> if and only if
</p><ul>
<li>
for all <i>i</i> = 1,..., <i>k</i>, either 1 ≤ |<i>w</i><sub><i>i</i></sub>| &lt; <i>F</i>, or |<i>w</i><sub><i>i</i></sub>| = |<i>d</i><sub><i>j</i></sub>|
for some <i>j</i> ∈ {1,..., <i>m</i>},
</li>
<li>
there is no 1 ≤ <i>i</i> &lt; <i>k</i> such that |<i>w</i><sub><i>i</i></sub>| &lt; <i>F</i> and |<i>w</i><sub><i>i</i>+1</sub>| &lt; <i>F</i>.
</li>
</ul>
For a feasible factorization <i>T</i> = <i>w</i><sub>1</sub>...<i>w</i><sub><i>k</i></sub>, we define its Hamming distance to <i>D</i> as the sum
<i>C</i>(<i>w</i><sub>1</sub>) + ... + <i>C</i>(<i>w</i><sub><i>k</i></sub>), where
<ul>
<li>
<i>C</i>(<i>w</i><sub><i>i</i></sub>) = 1, if |<i>w</i><sub><i>i</i></sub>| &lt; <i>F</i>,
</li>
<li>
<i>C</i>(<i>w</i><sub><i>i</i></sub>) = min{HD(<i>w</i><sub><i>i</i></sub>, <i>d</i>) : <i>d</i> ∈ <i>D</i> ∧ |<i>d</i>| = |<i>w</i><sub><i>i</i></sub>|},
otherwise.
</li>
</ul>

We define the Hamming dictionary distance HDD(<i>T</i>, <i>D</i>, <i>F</i>) of <i>T</i> with respect to <i>D</i> and <i>F</i> as the
as the minimum Hamming distance of <i>T</i> to <i>D</i> over all feasible factorizations of <i>T</i>.

<p></p>

<h3><font color="blue">The task</font></h3>
<p align="justify">
For a given <i>T</i>, <i>D</i> and <i>F</i>, calculate HDD(<i>T</i>, <i>D</i>, <i>F</i>).

<br>
<br>

</p>

<hr>

<h3><font color="blue">Input</font></h3>
<p align="justify">
The first input line contains integers <i>N</i>, <i>F</i> separated by space.
The next <i>N</i> lines represent <i>N</i> words of a dictionary <i>D</i>, each line contains one word over <i>A</i> = {'a',..., 'z'}.
Note that these words are not necessarily different from each other.
One more line follows, containing a text <i>T</i> over <i>A</i>.
<br>
The following limits hold:
1 ≤ <i>N</i> ≤ 130;
3 ≤ <i>F</i> ≤ 20;
1 ≤ |<i>T</i>| ≤ 140000;
each word of <i>D</i> is of length at least <i>F</i> and not greater than 130.
<br>
It is ensured that there is at least one feasible factorization of <i>T</i> with respect to <i>D</i> and <i>F</i>.


</p>

<h3><font color="blue">Output</font></h3>
<p align="justify">
The output consists of one line containing integer <i>H</i> which is equal to HDD(<i>T</i>, <i>D</i>, <i>F</i>).

</p><h3><font color="blue">Example 1</font></h3>
<b>Input</b><br>
<pre>3 3
abab
aaa
bbbaa
ababbbbbaaaaacc
</pre>

<b>Output</b><br>
<pre>2
</pre>

abab|b|bbbaa|aaa|cc is an optimal feasible factorization of the text, consisting of three words from the dictionary and two substrings of length less than <i>F</i> = 3.

<h3><font color="blue">Example 2</font></h3>
<b>Input</b><br>
<pre>2 4
abab
cdcd
cddcdababbcddabcdcd
</pre>

<b>Output</b><br>
<pre>5
</pre>

An optimal feasible factorization: c|ddcd|abab|bc|ddab|cdcd.

<h3><font color="blue">Example 3</font></h3>
<b>Input</b><br>
<pre>1 3
lstnnt
tntlsdtnttntlsdlsdtnt
</pre>

<b>Output</b><br>
<pre>13
</pre>

An optimal feasible factorization: tntlsd|t|nttntl|sd|lsdtnt.

<hr>
<h3><font color="blue">Public data</font></h3>
<p align="justify">
The public data set is intended for easier debugging and approximate program correctness checking. The public data set is stored also in the upload system and each time a student submits a solution it is run on the public dataset and the program output to  stdout and stderr is available to him/her.
<br>
<a href="https://cw.felk.cvut.cz/brute/data/ae/release/2023z_b4m33pal/pal_2023/evaluation/getdata.php?task=dictdist&amp;item=datapub.zip"><b>Link to public data set</b></a>
</p>

</div>





</body></html>